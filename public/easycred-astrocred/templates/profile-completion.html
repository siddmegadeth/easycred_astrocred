<div class="container profile-container">
    <!-- Progress Steps -->
    <div class="progress-container">
        <div class="row text-center">
            <div class="col-3 progress-step">
                <div class="step-circle" ng-class="{'active': currentStep === 1, 'completed': currentStep > 1}">1</div>
                <div class="small fw-medium">Personal Info</div>
            </div>
            <div class="col-3 progress-step">
                <div class="step-circle" ng-class="{'active': currentStep === 2, 'completed': currentStep > 2}">2</div>
                <div class="small fw-medium">Address Details</div>
            </div>
            <div class="col-3 progress-step">
                <div class="step-circle" ng-class="{'active': currentStep === 3, 'completed': currentStep > 3}">3</div>
                <div class="small fw-medium">KYC Documents</div>
            </div>
            <div class="col-3 progress-step">
                <div class="step-circle" ng-class="{'active': currentStep === 4, 'completed': currentStep > 4}">4</div>
                <div class="small fw-medium">Consent</div>
            </div>
        </div>
    </div>
    <!-- Profile Completion Form -->
    <div class="card">
        <div class="card-header">
            <h3 class="mb-0"><i class="fas fa-user-plus me-2"></i>Complete Your Profile</h3>
            <p class="mb-0 opacity-75">Please complete all required fields to activate your account</p>
        </div>
        <div class="card-body p-4">
            <!-- Step 1: Personal Information -->
            <div class="form-section" ng-class="{'active': currentStep === 1}">
                <h4 class="mb-4">Personal Information</h4>
                <div class="row g-3">
                    <!-- Full Name -->
                    <div class="col-md-6">
                        <label class="form-label required">Full Name</label>
                        <input type="text" class="form-control" ng-model="profile.profile_info.fullname" ng-class="{'is-invalid': errors.fullname, 'is-valid': profile.profile_info.fullname && !errors.fullname}" placeholder="Enter your full name" required>
                        <div class="validation-error" ng-class="{'show': errors.fullname}">
                            {{errors.fullname}}
                        </div>
                    </div>
                    <!-- Email -->
                    <div class="col-md-6">
                        <label class="form-label required">Email Address</label>
                        <input type="email" class="form-control" ng-model="profile.profile_info.email" ng-class="{'is-invalid': errors.email, 'is-valid': profile.profile_info.email && !errors.email && validateEmail(profile.profile_info.email)}" placeholder="you@example.com" required>
                        <div class="validation-error" ng-class="{'show': errors.email}">
                            {{errors.email}}
                        </div>
                        <div class="info-text">We'll send important updates to this email</div>
                    </div>
                    <!-- Mobile Number -->
                    <div class="col-md-6">
                        <label class="form-label required">Mobile Number</label>
                        <div class="input-group">
                            <input disabled class="form-control" id="mobileNumber" ng-model="profile.profile_info.mobile" ng-class="{'is-invalid': errors.mobile, 'is-valid': profile.profile_info.mobile && !errors.mobile && validateMobile(profile.profile_info.mobile)}">
                        </div>
                        <div class="validation-error" ng-class="{'show': errors.mobile}">
                            {{errors.mobile}}
                        </div>
                    </div>
                    <!-- Date of Birth -->
                    <div class="col-md-6">
                        <label class="form-label required">Date of Birth</label>
                        <input type="date" class="form-control" ng-model="profile.profile_info.date_of_birth" ng-class="{'is-invalid': errors.date_of_birth, 'is-valid': profile.profile_info.date_of_birth && !errors.date_of_birth && validateDOB(profile.profile_info.date_of_birth)}" max="{{maxDOBDate}}" required>
                        <div class="validation-error" ng-class="{'show': errors.date_of_birth}">
                            {{errors.dob}}
                        </div>
                        <div class="info-text">Must be 18+ years old</div>
                    </div>
                    <!-- Gender -->
                    <div class="col-md-6">
                        <label class="form-label required">Gender</label>
                        <select class="form-select" ng-model="profile.profile_info.gender" ng-class="{'is-invalid': errors.gender, 'is-valid': profile.profile_info.gender}">
                            <option value="">Select Gender</option>
                            <option value="MALE">Male</option>
                            <option value="FEMALE">Female</option>
                            <option value="OTHER">Other</option>
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.gender}">
                            {{errors.gender}}
                        </div>
                    </div>
                    <!-- Marital Status -->
                    <div class="col-md-6">
                        <label class="form-label required">Marital Status</label>
                        <select class="form-select" ng-model="profile.profile_info.maritalStatus" ng-class="{'is-invalid': errors.maritalStatus, 'is-valid': profile.profile_info.maritalStatus}">
                            <option value="">Select Status</option>
                            <option value="SINGLE">Single</option>
                            <option value="MARRIED">Married</option>
                            <option value="DIVORCED">Divorced</option>
                            <option value="WIDOWED">Widowed</option>
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.maritalStatus}">
                            {{errors.maritalStatus}}
                        </div>
                    </div>
                    <!-- Employment Type -->
                    <div class="col-md-6">
                        <label class="form-label required">Employment Type</label>
                        <select class="form-select" ng-model="profile.profile_info.employmentType" ng-class="{'is-invalid': errors.employmentType, 'is-valid': profile.profile_info.employmentType}">
                            <option value="">Select Employment Type</option>
                            <option value="SALARIED">Salaried</option>
                            <option value="SELF_EMPLOYED">Self Employed</option>
                            <option value="BUSINESS">Business</option>
                            <option value="STUDENT">Student</option>
                            <option value="RETIRED">Retired</option>
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.employmentType}">
                            {{errors.employmentType}}
                        </div>
                    </div>
                    <!-- Monthly Income -->
                    <div class="col-md-6">
                        <label class="form-label required">Monthly Income (₹)</label>
                        <select class="form-select" ng-model="profile.profile_info.monthlyIncome" ng-class="{'is-invalid': errors.monthlyIncome, 'is-valid': profile.profile_info.monthlyIncome}">
                            <option value="">Select Income Range</option>
                            <option value="10000">Less than ₹20,000</option>
                            <option value="20000">₹20,000 - ₹40,000</option>
                            <option value="40000">₹40,000 - ₹60,000</option>
                            <option value="60000">₹60,000 - ₹80,000</option>
                            <option value="80000">₹80,000 - ₹1,00,000</option>
                            <option value="100000">Above ₹1,00,000</option>
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.monthlyIncome}">
                            {{errors.monthlyIncome}}
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-4">
                    <button class="btn btn-outline-primary" disabled>Previous</button>
                    <button class="btn btn-primary" ng-click="validateStep1()">
                        Next: <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            <!-- Step 2: Address Details -->
            <div class="form-section" ng-class="{'active': currentStep === 2}">
                <h4 class="mb-4">Address Details</h4>
                <div class="row g-3">
                    <!-- Address Line 1 -->
                    <div class="col-12">
                        <label class="form-label required">Address Line 1</label>
                        <input type="text" class="form-control" ng-model="profile.props.addressLine1" ng-class="{'is-invalid': errors.addressLine1, 'is-valid': profile.props.addressLine1 && !errors.addressLine1}" placeholder="House/Flat No, Building, Street">
                        <div class="validation-error" ng-class="{'show': errors.addressLine1}">
                            {{errors.addressLine1}}
                        </div>
                    </div>
                    <!-- Address Line 2 -->
                    <div class="col-12">
                        <label class="form-label">Address Line 2 (Optional)</label>
                        <input type="text" class="form-control" ng-model="profile.props.addressLine2" placeholder="Area, Locality">
                    </div>
                    <!-- City -->
                    <div class="col-md-6">
                        <label class="form-label required">City</label>
                        <input type="text" class="form-control" ng-model="profile.props.city" ng-class="{'is-invalid': errors.city, 'is-valid': profile.props.city && !errors.city}" placeholder="Enter city">
                        <div class="validation-error" ng-class="{'show': errors.city}">
                            {{errors.city}}
                        </div>
                    </div>
                    <!-- State -->
                    <div class="col-md-6">
                        <label class="form-label required">State</label>
                        <select class="form-select" ng-model="profile.props.state" ng-class="{'is-invalid': errors.state, 'is-valid': profile.props.state}">
                            <option value="">Select State</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Uttar Pradesh">Uttar Pradesh</option>
                            <option value="Gujarat">Gujarat</option>
                            <option value="West Bengal">West Bengal</option>
                            <option value="Rajasthan">Rajasthan</option>
                            <option value="Bihar">Bihar</option>
                            <!-- Add all Indian states -->
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.state}">
                            {{errors.state}}
                        </div>
                    </div>
                    <!-- Pincode -->
                    <div class="col-md-6">
                        <label class="form-label required">Pincode</label>
                        <input type="text" class="form-control" ng-model="profile.props.pincode" ng-class="{'is-invalid': errors.pincode, 'is-valid': profile.props.pincode && !errors.pincode && validatePincode(profile.props.pincode)}" placeholder="6-digit pincode" maxlength="6">
                        <div class="validation-error" ng-class="{'show': errors.pincode}">
                            {{errors.pincode}}
                        </div>
                    </div>
                    <!-- Country -->
                    <div class="col-md-6">
                        <label class="form-label required">Country</label>
                        <select class="form-select" ng-model="profile.props.country" ng-class="{'is-invalid': errors.country, 'is-valid': profile.props.country}">
                            <option value="India" selected>India</option>
                            <option value="USA">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="Canada">Canada</option>
                            <option value="Australia">Australia</option>
                        </select>
                        <div class="validation-error" ng-class="{'show': errors.country}">
                            {{errors.country}}
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-4">
                    <button class="btn btn-outline-primary" ng-click="goToStep(1)">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button class="btn btn-primary" ng-click="validateStep2()">
                        Next: <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            <!-- Step 3: KYC Documents -->
            <div class="form-section" ng-class="{'active': currentStep === 3}">
                <h4 class="mb-4">KYC Verification</h4>
                <p class="text-muted mb-4">Upload your documents for identity verification (Max size: 2MB each)</p>
                <div class="row g-4">
                    <!-- PAN Card -->
                    <div class="col-md-6">
                        <div class="mt-3">
                            <label class="form-label required">PAN Number</label>
                            <input type="text" class="form-control text-uppercase" ng-model="profile.kyc.pan_number" ng-class="{'is-invalid': errors.pan_number, 'is-valid': profile.kyc.pan_number && !errors.pan_number && validatePAN(profile.kyc.pan_number)}" placeholder="ABCDE1234F" maxlength="10">
                            <div class="validation-error" ng-class="{'show': errors.pan_number}">
                                {{errors.pan_number}}
                            </div>
                        </div>
                    </div>
                    <!-- Aadhaar Card -->
                    <div class="col-md-6">
                        <div class="mt-3">
                            <label class="form-label required">Aadhaar Number</label>
                            <input type="text" class="form-control" ng-model="profile.kyc.aadhaar_number" ng-class="{'is-invalid': errors.aadhaar_number, 'is-valid': profile.kyc.aadhaar_number && !errors.aadhaar_number && validateAadhaar(profile.kyc.aadhaar_number)}" placeholder="12-digit Aadhaar number" maxlength="12">
                            <div class="validation-error" ng-class="{'show': errors.aadhaar_number}">
                                {{errors.aadhaar_number}}
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Selfie Verification -->
                <div class="d-flex justify-content-between mt-4">
                    <button class="btn btn-outline-primary" ng-click="goToStep(2)">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button class="btn btn-primary" ng-click="validateStep3()">
                        Next: <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </div>
            </div>
            <!-- Step 4: Consent & Terms -->
            <div class="form-section" ng-class="{'active': currentStep === 4}">
                <h4 class="mb-4">Terms & Consent</h4>
                <div class="terms-checkbox mb-4">
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="terms" ng-model="profile.consent.terms" ng-class="{'is-invalid': errors.terms}">
                        <label class="form-check-label" for="terms">
                            I agree to the <a href class="text-primary">Terms of Service</a> and <a href class="text-primary">Privacy Policy</a>
                        </label>
                        <div class="validation-error" ng-class="{'show': errors.terms}">
                            {{errors.terms}}
                        </div>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="aadhaarConsent" ng-model="profile.consent.aadhaar" ng-class="{'is-invalid': errors.aadhaarConsent}">
                        <label class="form-check-label" for="aadhaarConsent">
                            I consent to share my Aadhaar details for KYC verification as per RBI guidelines
                        </label>
                        <div class="validation-error" ng-class="{'show': errors.aadhaarConsent}">
                            {{errors.aadhaarConsent}}
                        </div>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="panConsent" ng-model="profile.consent.pan" ng-class="{'is-invalid': errors.panConsent}">
                        <label class="form-check-label" for="panConsent">
                            I consent to share my PAN details for financial verification as per Income Tax regulations
                        </label>
                        <div class="validation-error" ng-class="{'show': errors.panConsent}">
                            {{errors.panConsent}}
                        </div>
                    </div>
                </div>
                <!-- Email Updates -->
                <div class="mb-4">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="emailUpdates" ng-model="profile.communication.emailUpdates" checked>
                        <label class="form-check-label" for="emailUpdates">
                            Receive email updates about new features and offers
                        </label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="smsUpdates" ng-model="profile.communication.smsUpdates" checked>
                        <label class="form-check-label" for="smsUpdates">
                            Receive SMS alerts for transactions and important updates
                        </label>
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-4">
                    <button class="btn btn-outline-primary" ng-click="goToStep(3)">
                        <i class="fas fa-arrow-left me-2"></i> Previous
                    </button>
                    <button class="btn btn-primary" ng-click="submitProfile()" ng-disabled="isSubmitting">
                        <span class="loading-spinner"></span>
                        {{isSubmitting ? 'Submitting...' : 'Complete Profile'}}
                    </button>
                </div>
            </div>
            <!-- Success Screen -->
            <div class="form-section success-screen" ng-class="{'active': isComplete}">
                <div class="success-icon">
                    <i class="fas fa-check"></i>
                </div>
                <h3 class="mb-3">Profile Completed Successfully!</h3>
                <p class="text-muted mb-4">Your profile has been submitted for verification. You'll receive an update within 24 hours.</p>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="card border-success">
                            <div class="card-body text-center">
                                <i class="fas fa-qrcode text-success fs-1 mb-3"></i>
                                <h5>Customer ID</h5>
                                <p class="text-monospace">{{customerId}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-primary">
                            <div class="card-body text-center">
                                <i class="fas fa-clock text-primary fs-1 mb-3"></i>
                                <h5>Verification Time</h5>
                                <p>24-48 Hours</p>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary mt-4" ng-click="goToDashboard()">
                    Go to Dashboard <i class="fas fa-arrow-right ms-2"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="privacy-text">
        <p>Your information is secured with 256-bit SSL encryption. We comply with RBI's data protection guidelines.</p>
    </div>
</div>
<style>
.profile-container {
    max-width: 900px;
    margin: 0 auto;
}

.card {
    border: none;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    margin-bottom: 30px;
}

.card-header {
    background: linear-gradient(135deg, var(--astrocred-primary), var(--astrocred-accent));
    color: white;
    border-radius: 20px 20px 0 0 !important;
    padding: 25px;
}

.progress-container {
    background: white;
    padding: 20px;
    border-radius: 15px;
    margin-bottom: 30px;
}

.progress-step {
    text-align: center;
    padding: 15px;
    position: relative;
}

.step-circle {
    width: 57px;
    height: 57px;
    border-radius: 25%;
    background: #e9ecef;
    color: #6c757d;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 10px;
    font-weight: 600;
    transition: all 0.3s;
}

.step-circle.active {
    background: linear-gradient(135deg, var(--astrocred-primary), var(--astrocred-accent));
    color: white;
    box-shadow: 0 5px 15px rgba(122, 44, 191, 0.3);
}

.step-circle.completed {
    background: var(--astrocred-success);
    color: white;
}

.form-section {
    display: none;
    animation: fadeIn 0.5s;
}

.form-section.active {
    display: block;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.form-label {
    font-weight: 600;
    color: var(--astrocred-primary);
    margin-bottom: 8px;
}

.form-control,
.form-select {
    border: 2px solid #e9ecef;
    border-radius: 10px;
    padding: 12px 15px;
    transition: all 0.3s;
}

.form-control:focus,
.form-select:focus {
    border-color: var(--astrocred-accent);
    box-shadow: 0 0 0 0.25rem rgba(123, 44, 191, 0.25);
}

.form-control.is-invalid,
.form-select.is-invalid {
    border-color: var(--astrocred-danger);
}

.form-control.is-valid,
.form-select.is-valid {
    border-color: var(--astrocred-success);
}

.info-text {
    font-size: 0.875rem;
    color: #6c757d;
    margin-top: 5px;
}

.validation-error {
    color: var(--astrocred-danger);
    font-size: 0.875rem;
    margin-top: 5px;
    display: none;
}

.validation-error.show {
    display: block;
}

.required::after {
    content: " *";
    color: var(--astrocred-danger);
}

.btn-primary {
    background: linear-gradient(135deg, var(--astrocred-primary), var(--astrocred-accent));
    border: none;
    border-radius: 10px;
    padding: 12px 30px;
    font-weight: 600;
    transition: all 0.3s;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(122, 44, 191, 0.3);
}

.btn-outline-primary {
    border: 2px solid var(--astrocred-primary);
    color: var(--astrocred-primary);
    border-radius: 10px;
    padding: 12px 30px;
    font-weight: 600;
}

.btn-outline-primary:hover {
    background: var(--astrocred-primary);
    color: white;
}

.document-preview {
    border: 2px dashed #dee2e6;
    border-radius: 10px;
    padding: 30px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

.document-preview:hover {
    border-color: var(--astrocred-accent);
    background: rgba(123, 44, 191, 0.05);
}

.document-preview i {
    font-size: 48px;
    color: var(--astrocred-accent);
    margin-bottom: 15px;
}

.terms-checkbox {
    border: 2px solid #dee2e6;
    border-radius: 10px;
    padding: 20px;
    background: #f8f9fa;
}

.success-screen {
    text-align: center;
    padding: 50px 20px;
}

.success-icon {
    width: 100px;
    height: 100px;
    background: linear-gradient(135deg, var(--astrocred-success), #27ae60);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 30px;
    color: white;
    font-size: 48px;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }

    100% {
        transform: scale(1);
    }
}

.nav-tabs {
    border-bottom: 2px solid #dee2e6;
}

.nav-tabs .nav-link {
    border: none;
    color: #6c757d;
    font-weight: 500;
    padding: 12px 25px;
    border-radius: 10px 10px 0 0;
    margin-right: 5px;
}

.nav-tabs .nav-link.active {
    color: var(--astrocred-primary);
    background: white;
    border-bottom: 3px solid var(--astrocred-accent);
}

.privacy-text {
    font-size: 0.75rem;
    color: #6c757d;
    text-align: center;
    margin-top: 20px;
}

.loading-spinner {
    display: none;
    width: 20px;
    height: 20px;
    border: 3px solid #f3f3f3;
    border-top: 3px solid var(--astrocred-accent);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-right: 10px;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

.btn:disabled .loading-spinner {
    display: inline-block;
}
</style>